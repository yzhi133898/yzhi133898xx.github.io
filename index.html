<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>墨香书苑 - 散文精选</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* 基础样式重置 */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding-top: 70px; /* 为固定导航栏预留空间 */
        }

        /* 导航栏样式 */
        .navbar {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .nav-logo {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-link {
            text-decoration: none;
            color: #2c3e50;
            font-weight: 500;
            transition: color 0.3s ease;
            position: relative;
        }

        .nav-link:hover {
            color: #3498db;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: #3498db;
            transition: width 0.3s ease;
        }

        .nav-link:hover::after {
            width: 100%;
        }

        .nav-toggle {
            display: none;
            flex-direction: column;
            cursor: pointer;
        }

        .bar {
            width: 25px;
            height: 3px;
            background: #2c3e50;
            margin: 3px 0;
            transition: 0.3s;
        }

        /* 搜索框样式 */
        .search-container {
            position: relative;
            display: flex;
            align-items: center;
            margin-right: 1rem;
        }

        .search-input {
            padding: 8px 15px 8px 35px;
            border: 1px solid #ddd;
            border-radius: 20px;
            font-size: 0.9rem;
            width: 200px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #3498db;
            width: 250px;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .search-icon {
            position: absolute;
            left: 12px;
            color: #95a5a6;
        }

        /* 用户菜单样式 */
        .user-menu {
            position: relative;
        }

        .user-btn {
            background: none;
            border: none;
            color: #2c3e50;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .user-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            width: 180px;
            padding: 10px 0;
            display: none;
            z-index: 1001;
        }

        .user-dropdown.active {
            display: block;
        }

        .user-dropdown-item {
            padding: 8px 15px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .user-dropdown-item:hover {
            background: #f5f7fa;
        }

        /* 发布按钮样式 */
        .publish-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
        }
        
        .publish-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }

        /* 首页横幅样式 */
        .hero {
            min-height: calc(100vh - 70px);
            display: grid;
            grid-template-columns: 1fr 1fr;
            align-items: center;
            padding: 4rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-content {
            padding: 2rem;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-subtitle {
            font-size: 1.2rem;
            color: #7f8c8d;
            margin-bottom: 2rem;
        }

        .cta-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .hero-image {
            text-align: center;
        }

        .hero-img {
            width: 100%;
            max-width: 500px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }

        /* 文章列表区域样式 */
        .articles-section {
            padding: 4rem 2rem;
            background: white;
            margin: 2rem auto;
            max-width: 1200px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-header h3 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .section-header p {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        /* 分类筛选样式 */
        .categories-filter {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .category-btn {
            background: #f5f7fa;
            border: none;
            padding: 6px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #2c3e50;
        }

        .category-btn.active {
            background: #3498db;
            color: white;
        }

        .articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
        }

        .article-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .article-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }

        .article-category {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(52, 152, 219, 0.8);
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
        }

        .article-image-container {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .article-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .article-card:hover .article-image {
            transform: scale(1.05);
        }

        .article-content {
            padding: 1.5rem;
        }

        .article-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 0.5rem;
        }

        .article-excerpt {
            color: #7f8c8d;
            font-size: 0.95rem;
            line-height: 1.5;
        }

        .article-actions {
            display: flex;
            gap: 15px;
            margin-top: 1rem;
        }

        .action-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            background: none;
            border: none;
            color: #95a5a6;
            cursor: pointer;
            font-size: 0.9rem;
            transition: color 0.3s ease;
        }

        .action-btn:hover {
            color: #3498db;
        }

        .action-btn.liked {
            color: #e74c3c;
        }

        .action-btn.bookmarked {
            color: #f39c12;
        }

        .article-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #ecf0f1;
            font-size: 0.85rem;
            color: #95a5a6;
        }

        /* 文章详情页样式 */
        .article-detail-section {
            padding: 4rem 2rem;
            background: white;
            margin: 2rem auto;
            max-width: 800px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none; /* 默认隐藏 */
        }

        .detail-header {
            margin-bottom: 2rem;
            text-align: center;
        }

        .detail-category {
            display: inline-block;
            background: #3498db;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }

        .detail-title {
            font-size: 2.2rem;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .detail-meta {
            color: #95a5a6;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }

        .detail-image {
            width: 100%;
            max-height: 500px;
            overflow: hidden;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .detail-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .detail-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 2rem 0;
        }

        .detail-action-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            background: none;
            border: 1px solid #3498db;
            color: #3498db;
            padding: 8px 20px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .detail-action-btn:hover {
            background: #3498db;
            color: white;
        }

        .detail-action-btn.liked {
            background: #e74c3c;
            border-color: #e74c3c;
            color: white;
        }

        .detail-action-btn.bookmarked {
            background: #f39c12;
            border-color: #f39c12;
            color: white;
        }

        .detail-content {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #333;
        }

        .detail-content p {
            margin-bottom: 1.5rem;
        }

        .back-link {
            display: inline-block;
            margin-bottom: 2rem;
            color: #3498db;
            text-decoration: none;
            font-weight: 500;
        }

        .back-link:hover {
            text-decoration: underline;
        }

        /* 评论区样式 */
        .comments-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #ecf0f1;
        }

        .comments-header {
            margin-bottom: 1.5rem;
        }

        .comments-list {
            margin-bottom: 2rem;
        }

        .comment-item {
            padding: 1rem;
            background: #f9f9f9;
            border-radius: 10px;
            margin-bottom: 1rem;
        }

        .comment-author {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: #2c3e50;
        }

        .comment-date {
            font-size: 0.8rem;
            color: #95a5a6;
            margin-bottom: 0.5rem;
        }

        .comment-content {
            color: #555;
        }

        .comment-form {
            background: #f9f9f9;
            padding: 1.5rem;
            border-radius: 10px;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-control {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }

        /* 发布文章表单样式 - 默认隐藏 */
        .publish-section {
            padding: 4rem 2rem;
            background: white;
            margin: 2rem auto;
            max-width: 800px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none; /* 默认隐藏发布区域 */
        }

        .image-preview {
            width: 100%;
            height: 200px;
            border: 2px dashed #ddd;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-top: 0.5rem;
            overflow: hidden;
            position: relative;
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .image-preview span {
            color: #7f8c8d;
        }

        .random-image-note {
            font-size: 0.9rem;
            color: #7f8c8d;
            margin-top: 0.5rem;
            font-style: italic;
        }

        .submit-btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        /* 画廊样式 */
        .gallery-section {
            padding: 4rem 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: 2rem auto;
            max-width: 1200px;
            border-radius: 20px;
        }

        .gallery-container {
            position: relative;
            max-width: 800px;
            margin: 0 auto;
        }

        .gallery-slider {
            display: flex;
            overflow: hidden;
            border-radius: 15px;
        }

        .gallery-slide {
            min-width: 100%;
            transition: transform 0.5s ease;
        }

        .gallery-slide img {
            width: 100%;
            height: 400px;
            object-fit: cover;
        }

        .gallery-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 1rem;
        }

        .gallery-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .gallery-indicators {
            display: flex;
            gap: 0.5rem;
        }

        .gallery-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
        }

        .gallery-indicator.active {
            background: white;
        }

        /* 模态框样式 */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            display: none;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .modal-title {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .modal-footer {
            margin-top: 1.5rem;
            display: flex;
            justify-content: space-between;
        }

        .modal-btn {
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .modal-btn.primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }

        .modal-btn.secondary {
            background: #f5f7fa;
            color: #2c3e50;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #eee;
        }

        .auth-tab {
            padding: 10px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .auth-tab.active {
            border-bottom-color: #3498db;
            color: #3498db;
            font-weight: 600;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .error-message {
            color: #e74c3c;
            font-size: 0.9rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .user-info {
            text-align: center;
            padding: 1rem 0;
        }

        .user-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #3498db;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin: 0 auto 1rem;
        }

        /* 搜索结果提示 */
        .search-results-info {
            text-align: center;
            margin-bottom: 2rem;
            color: #7f8c8d;
            font-style: italic;
        }

        /* 收藏页面样式 */
        .bookmarks-section {
            padding: 4rem 2rem;
            background: white;
            margin: 2rem auto;
            max-width: 1200px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .empty-state {
            text-align: center;
            padding: 3rem 0;
            color: #7f8c8d;
        }

        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: #bdc3c7;
        }

        /* 页脚样式 */
        .footer {
            background: #2c3e50;
            color: white;
            padding: 2rem;
            text-align: center;
            margin-top: 4rem;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
        }

        .social-link {
            color: white;
            font-size: 1.2rem;
        }

        /* 响应式设计 */
        @media (max-width: 768px) {
            .search-container {
                margin-right: 0;
                margin-bottom: 1rem;
                width: 100%;
            }
            
            .search-input {
                width: 100%;
            }
            
            .search-input:focus {
                width: 100%;
            }
            
            .nav-menu {
                position: fixed;
                left: -100%;
                top: 70px;
                flex-direction: column;
                background: white;
                width: 100%;
                text-align: center;
                transition: 0.3s;
                padding: 1rem 0;
            }

            .nav-menu.active {
                left: 0;
            }
            
            .nav-menu .publish-btn {
                display: inline-block;
                margin: 10px 0;
            }

            .user-menu {
                margin-top: 10px;
            }

            .user-dropdown {
                right: auto;
                left: 50%;
                transform: translateX(-50%);
            }

            .nav-toggle {
                display: flex;
            }

            .hero {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .articles-grid {
                grid-template-columns: 1fr;
            }

            .detail-title {
                font-size: 1.8rem;
            }

            .modal-footer {
                flex-direction: column;
                gap: 10px;
            }

            .modal-btn {
                width: 100%;
            }
        }
        p{
            text-indent: 2em;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="navbar">
        <div class="nav-container">
            <h1 class="nav-logo">墨香书苑</h1>
            
            <!-- 搜索框 -->
            <div class="search-container">
                <i class="fas fa-search search-icon"></i>
                <input type="text" class="search-input" id="searchInput" placeholder="搜索文章...">
            </div>
            
            <ul class="nav-menu">
                <li class="nav-item"><a href="#home" class="nav-link">首页</a></li>
                <li class="nav-item"><a href="#articles" class="nav-link">散文精选</a></li>
                <li class="nav-item"><button class="publish-btn" id="publishToggle">发布文章</button></li>
                <li class="nav-item"><a href="#gallery" class="nav-link">意境图集</a></li>
                <li class="nav-item"><a href="#about" class="nav-link">关于我们</a></li>
                <li class="nav-item user-menu">
                    <button class="user-btn" id="userBtn">
                        <i class="fas fa-user"></i>
                        <span id="userMenuText">登录</span>
                    </button>
                    <div class="user-dropdown" id="userDropdown">
                        <div class="user-dropdown-item" id="profileItem">个人中心</div>
                        <div class="user-dropdown-item" id="bookmarksItem">我的收藏</div>
                        <div class="user-dropdown-item" id="logoutItem">退出登录</div>
                    </div>
                </li>
            </ul>
            <div class="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <!-- 首页横幅 -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h2 class="hero-title">在文字中寻找心灵的栖息地</h2>
            <p class="hero-subtitle">品味生活，感悟人生，让散文温暖你的时光</p>
            <button class="cta-button" onclick="scrollToArticles()">开始阅读</button>
        </div>
        <div class="hero-image">
            <img src="https://picsum.photos/800/400?random=1" alt="宁静的图书馆阅读场景" class="hero-img">
        </div>
    </section>

    <!-- 散文精选列表 -->
    <section id="articles" class="articles-section">
        <div class="section-header">
            <h3>散文精选</h3>
            <p>精选优美散文，感受文字的魅力</p>
        </div>
        
        <!-- 搜索结果提示 -->
        <div class="search-results-info" id="searchResultsInfo" style="display: none;"></div>
        
        <!-- 分类筛选 -->
        <div class="categories-filter" id="categoriesFilter">
            <button class="category-btn active" data-category="all">全部</button>
            <!-- 分类将通过JavaScript动态生成 -->
        </div>
        
        <div class="articles-grid" id="articlesGrid">
            <!-- 文章将通过JavaScript动态加载 -->
        </div>
    </section>

    <!-- 我的收藏 -->
    <section id="bookmarks" class="bookmarks-section">
        <div class="section-header">
            <h3>我的收藏</h3>
            <p>珍藏那些触动心灵的文字</p>
        </div>
        
        <div class="articles-grid" id="bookmarksGrid">
            <!-- 收藏的文章将通过JavaScript动态加载 -->
        </div>
    </section>

    <!-- 文章详情页 -->
    <section id="articleDetail" class="article-detail-section">
        <a href="#" class="back-link" onclick="showArticlesList(event)">
            <i class="fas fa-arrow-left"></i> 返回文章列表
        </a>
        
        <div class="detail-header">
            <span class="detail-category" id="detailCategory"></span>
            <h1 class="detail-title" id="detailTitle"></h1>
            <div class="detail-meta" id="detailMeta"></div>
            <div class="detail-image">
                <img src="" alt="" id="detailImage">
            </div>
            
            <div class="detail-actions">
                <button class="detail-action-btn" id="likeBtn">
                    <i class="fas fa-heart"></i>
                    <span id="likeText">点赞</span>
                    <span id="likeCount">(0)</span>
                </button>
                <button class="detail-action-btn" id="bookmarkBtn">
                    <i class="fas fa-bookmark"></i>
                    <span id="bookmarkText">收藏</span>
                </button>
            </div>
        </div>
        
        <div class="detail-content" id="detailContent">
            <!-- 文章内容将通过JavaScript动态加载 -->
        </div>

        <!-- 评论区 -->
        <div class="comments-section">
            <h3 class="comments-header">读者评论</h3>
            
            <div class="comments-list" id="commentsList">
                <!-- 评论将通过JavaScript动态加载 -->
            </div>
            
            <div class="comment-form">
                <h4>发表评论</h4>
                <form id="commentForm">
                    <div class="form-group">
                        <label for="commentAuthor" class="form-label">您的姓名</label>
                        <input type="text" id="commentAuthor" class="form-control" placeholder="请输入您的姓名" required disabled>
                        <div class="error-message">请先登录后再评论</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="commentContent" class="form-label">评论内容</label>
                        <textarea id="commentContent" class="form-control" placeholder="分享您的想法..." required disabled></textarea>
                    </div>
                    
                    <button type="submit" class="submit-btn">提交评论</button>
                </form>
            </div>
        </div>
    </section>

    <!-- 发布文章 -->
    <section id="publish" class="publish-section">
        <div class="section-header">
            <h3>发布新文章</h3>
            <p>分享你的散文作品，与读者共同感受文字之美</p>
        </div>
        
        <form id="publishForm">
            <div class="form-group">
                <label for="category" class="form-label">文章分类</label>
                <select id="category" class="form-control" required>
                    <option value="">请选择分类</option>
                    <option value="生活随笔">生活随笔</option>
                    <option value="山水游记">山水游记</option>
                    <option value="情感感悟">情感感悟</option>
                    <option value="读书心得">读书心得</option>
                    <option value="哲理思辨">哲理思辨</option>
                    <option value="散文诗集">哲理思辨</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="title" class="form-label">文章标题</label>
                <input type="text" id="title" class="form-control" placeholder="请输入文章标题" required>
            </div>
            
            <div class="form-group">
                <label for="author" class="form-label">作者</label>
                <input type="text" id="author" class="form-control" placeholder="请输入作者姓名" required>
            </div>
            
            <div class="form-group">
                <label for="content" class="form-label">文章内容</label>
                <textarea id="content" class="form-control" placeholder="请输入文章内容..." required></textarea>
            </div>
            
            <div class="form-group">
                <label for="excerpt" class="form-label">内容摘要</label>
                <textarea id="excerpt" class="form-control" placeholder="请输入文章摘要（将显示在文章列表中）" required></textarea>
            </div>
            
            <div class="form-group">
                <label for="image" class="form-label">文章配图（可选）</label>
                <input type="file" id="image" class="form-control" accept="image/*">
                <div class="image-preview" id="imagePreview">
                    <span>未选择图片，将使用随机图片</span>
                </div>
                <p class="random-image-note">提示：如果不选择图片，系统将自动分配一张与散文意境相符的随机图片</p>
            </div>
            
            <button type="submit" class="submit-btn">发布文章</button>
        </form>
    </section>

    <!-- 意境图集 -->
    <section id="gallery" class="gallery-section">
        <div class="section-header">
            <h3>意境图集</h3>
            <p>与散文相得益彰的优美画面</p>
        </div>
        <div class="gallery-container">
            <div class="gallery-slider" id="gallerySlider">
                <!-- 图片将通过JavaScript动态加载 -->
            </div>
            <div class="gallery-controls">
                <button class="gallery-btn prev-btn" onclick="prevSlide()">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="gallery-indicators" id="galleryIndicators">
                    <!-- 指示器将通过JavaScript动态生成 -->
                </div>
                <button class="gallery-btn next-btn" onclick="nextSlide()">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </section>

    <!-- 关于我们 -->
    <section id="about" class="articles-section">
        <div class="section-header">
            <h3>关于我们</h3>
            <p>墨香书苑的故事</p>
        </div>
        <div style="max-width: 800px; margin: 0 auto; line-height: 1.8;">
            <p style="margin-bottom: 1.5rem;">墨香书苑创办于2020年，是一个专注于散文分享与交流的平台。我们致力于发掘和传播优秀的散文作品，让更多人感受文字之美，体验阅读之乐。</p>
            <p>在这里，你可以读到朱自清的淡雅、鲁迅的深刻、沈从文的质朴，也能发现当代优秀作家的新锐之作。我们相信，好的文字能够跨越时空，触动人心。</p>
        </div>
    </section>

    <!-- 成功提示模态框 -->
    <div class="modal" id="successModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <h2 class="modal-title">操作成功</h2>
            <p class="modal-message" id="successMessage">您的操作已成功完成！</p>
            <button class="cta-button" onclick="closeModal()">确定</button>
        </div>
    </div>

    <!-- 登录注册模态框 -->
    <div class="modal" id="authModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeAuthModal()">&times;</button>
            <h2 class="modal-title">用户中心</h2>
            
            <div class="auth-tabs">
                <div class="auth-tab active" data-tab="login">登录</div>
                <div class="auth-tab" data-tab="register">注册</div>
            </div>
            
            <!-- 登录表单 -->
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label for="loginUsername" class="form-label">用户名</label>
                    <input type="text" id="loginUsername" class="form-control" placeholder="请输入用户名" required>
                    <div class="error-message" id="loginUserError"></div>
                </div>
                
                <div class="form-group">
                    <label for="loginPassword" class="form-label">密码</label>
                    <input type="password" id="loginPassword" class="form-control" placeholder="请输入密码" required>
                    <div class="error-message" id="loginPwdError"></div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn secondary" onclick="closeAuthModal()">取消</button>
                    <button type="submit" class="modal-btn primary">登录</button>
                </div>
            </form>
            
            <!-- 注册表单 -->
            <form class="auth-form" id="registerForm">
                <div class="form-group">
                    <label for="regUsername" class="form-label">用户名</label>
                    <input type="text" id="regUsername" class="form-control" placeholder="请设置用户名" required>
                    <div class="error-message" id="regUserError"></div>
                </div>
                
                <div class="form-group">
                    <label for="regPassword" class="form-label">密码</label>
                    <input type="password" id="regPassword" class="form-control" placeholder="请设置密码（至少6位）" required>
                    <div class="error-message" id="regPwdError"></div>
                </div>
                
                <div class="form-group">
                    <label for="regConfirmPassword" class="form-label">确认密码</label>
                    <input type="password" id="regConfirmPassword" class="form-control" placeholder="请再次输入密码" required>
                    <div class="error-message" id="regConfirmError"></div>
                </div>
                
                <div class="modal-footer">
                    <button type="button" class="modal-btn secondary" onclick="closeAuthModal()">取消</button>
                    <button type="submit" class="modal-btn primary">注册</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 个人中心模态框 -->
    <div class="modal" id="profileModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">&times;</button>
            <h2 class="modal-title">个人中心</h2>
            
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">
                    <i class="fas fa-user"></i>
                </div>
                <h3 id="usernameDisplay"></h3>
                <p>加入时间: <span id="joinDate"></span></p>
            </div>
            
            <div class="form-group">
                <label class="form-label">我的文章</label>
                <div id="myArticlesContainer">
                    <!-- 我的文章将通过JavaScript动态加载 -->
                </div>
            </div>
            
            <div class="modal-footer">
                <button type="button" class="modal-btn primary" onclick="closeModal()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 墨香书苑 - 让阅读成为一种生活方式</p>
            <div class="social-links">
                <a href="#" class="social-link"><i class="fab fa-weixin"></i></a>
                <a href="#" class="social-link"><i class="fab fa-weibo"></i></a>
                <a href="#" class="social-link"><i class="fab fa-qq"></i></a>
            </div>
        </div>
    </footer>

    <script>
        // 文章分类
        const categories = ["生活随笔", "山水游记", "情感感悟", "读书心得", "哲理思辨","散文诗集"];
        
        // 文章数据 - 从localStorage获取，若无则使用默认数据
        let articles = JSON.parse(localStorage.getItem('articles')) || [
            {
                id: 1,
                title: "故乡的炊烟",
                excerpt: "美丽的故乡，常在梦中。故乡缕缕的炊烟，时常从我的心房飘起，引我进入乡愁弥漫为状态中。",
                image: "https://picsum.photos/400/200?random=2",
                author: "袁会志",
                date: "2029-06-15",
                readTime: "5分钟",
                category: "情感感悟",
                likes: 128,
                content: `<p>美丽的故乡，常在梦中。故乡缕缕的炊烟，时常从我的心房飘起，引我进入乡愁弥漫为状态中。</p>
                          <p>故乡的炊烟似一条坚韧缠绵的路，没有别的路比它更亲切传神。故乡人从这条路走过来，耕种养息，生儿育女，代代繁衍下去。</p>
                          <p>初识炊烟，是在我刚懂得采撷油菜花的童年。黄昏里，一些灰白的或浓黑的气从村民的厨房里飘出来，父亲告诉我那叫炊烟。是村民煮东西飘出了的烟。那时的炊烟是零散的，不怎么美丽。村民用的灶是祖辈沿袭下来的三角灶，没有烟囱，烟从灶的四周散开弥漫了厨房，然后才从窗口慢慢飘出去。烟多时人往往会被熏得很难受。清晨，我常看见母亲被烟熏得流泪和咳嗽不止，那时，我并不欣赏这种炊烟。  
                            七十年代初期，外出工作的老清叔知道外面正兴的节能灶不错，便请灶师傅在他家修建了节能灶。节能灶很好用，一灶能同时煮多锅的饭菜，省时又省燃料，且不污染厨房。在村长的倡议下，全村来了个改灶大热潮，家家户户都改建节能灶，大家的厨房后面都伸出条烟囱。从那时起，故乡的炊烟便变得美丽多了。我父亲不很懂泥水工，却懂得节能灶的原理，为了省钱，他自己动手改灶。我家的节能灶一灶动能同时煮五锅的饭菜，烟囱不算很直，却高大，通风性能好，我母亲从此避免被烟熏得流泪和咳嗽之苦了。</p>
                          <p>炊烟是故乡一道美丽的风景线，它镶嵌在乡情古朴的画框里。清晨和傍晚，是炊烟最多时，缕缕炊烟从一排排的烟肉里袅袅上升，那景观令人赞叹不止，我和同伴常跑到村后山坡上看炊烟。炊烟是变化无穷的，有的似水柔情，有的温馨浪漫；有时像云，在空中漫不经心地飘游；有时像雾，弥漫在树梢地角；有时形似一个白色的树冠，有时像故乡伸出的一双双小手.....我常被炊烟弄得如痴如醉。所以炊烟是我小学作文薄里写得最多的内容。</p>
                          <p>谁家的炊烟最特别，是我们小孩议论最多的话题，炊烟的一些特征往往会反映出一些家庭的情况。村里炊烟时间最长的，要数顺伯家，他家人口多，又养很多牲畜，煮的食物多，常常是别家的炊烟停了，他家的仍在源源不断地冒出，他家简直像个大食堂。炊烟又黑又浓的，是福伯家。他家劳动人口少，子女还小，没有备用木柴，常用湿木柴煮饭。炊烟最少的，是五保户全伯家，他煮一餐当三餐用。而我家的烟囱因砌得高大，通风透气，炊烟比别家的要高，我常为此感到自豪。</p>
                          <p>炊烟是母亲种植的一和纯朴的“植物”一年四季母亲不知为我们种植了多少这样的植物，倾注了多少汗水。这植物的绿荫覆盖着我的童年和多彩的梦。在这绿荫里，我看见母亲辛苦的面容和蹲在灶前忙碌做饭的身影。每天天未亮，母亲就得起床生火煮饭，弄好早餐后才把我从梦中叫醒，催促我吃早餐去上学。黄昏，劳累了一天的母亲还的在灶前劈柴做饭。多少年过去了，我始终未能忘记母亲的那份辛劳。在外工作的这些年里，我见过很多异乡的炊烟，但感觉它们都比不上故么的亲切和美丽。</p>
                          <p>久违了故乡的炊烟，总想看看故乡现在的炊烟。一个天气晴朗的日子，我特意驱车回家看炊烟。晚霞里我见到的不是从前的炊烟，故乡的炊烟少多了。正当我纳闷时，老村长似乎看透我的心思，走过来笑着告诉我，改革开放后，村民们的生活条件好了，很多家庭煮饭都用上了液化石油气，比以前清闲多了。老村长的话解开了我的疑惑。当我走进一些村民的家里时，看到的是和城市里一样的现代化厨房。那一台台的气炉上，正煮着香喷喷的饭菜。</p>
                          <p>故乡的炊烟已被新的东西取代了，但它将会永远飘荡在我的记忆里。</p>`
            },
            {
                id: 2,
                title: "故乡的金香河",
                excerpt: "故乡依山傍水，景色秀丽。在故乡东面的鹰山脚下，蜿蜒流淌着一条河，那便是故乡的金香河。",
                image: "https://picsum.photos/400/200?random=3",
                author: "袁会志",
                date: "2018-10-10",
                readTime: "8分钟",
                category: "情感感悟",
                likes: 95,
                content: `<p>故乡依山傍水，景色秀丽。在故乡东面的鹰山脚下，蜿蜒流淌着一条河，那便是故乡的金香河。</p>
                          <p>金香河是一条古老的河。它发源于遥远的异乡，绕过我们村后又奔腾不息地流入大海。登高远望，它宛如一条白色的绸带铺展在绿色的田野上。每年春天，金香河岸都飘溢着野花幽幽的香味。据说，金香河由此而得名。</p>
                          <p>金香河终年不息，河水润泽肥沃的十地，给故乡带来了富足。河两岸的果园、农田树林等，常是一片翠绿。故乡人祖祖辈辈在这片土地上耕种生养，良田稻谷飘香，瓜果满园，一片欣欣向荣的景象。</p>
                          <p>金香河水深、河肥，盛产淡水鱼。那鱼肥大,肉质香甜,与别的河的鱼有着质的区别。家乡人常张网捕捉，往往是满篓而归。金香河岸白沙成滩,卵石成堆，是村姑洗衣的好地方,那儿常充满她们的欢声笑语。金香河水清凉、洁净，还是人们夏季避暑的好去处。劳累了一天,晚饭后男人们便成群结队到河里冲凉,河水驱走了炎热,也带走了倦意。童年的我总爱和伙伴到河里游泳、打水仗。</p>
                          <p>说起来，我更爱金香河岸热烈奔放的花。在我童年的视野中，金香河是最美的地方。河堤上开满了各式各样的花，有粉红色的的桃花，有红得撩人的山丹丹，有蓝得空灵的牵牛花，有一紫一白的紫丁香，还有含娇带羞的勿忘我......五彩缤纷，争芬斗艳。彩蝶在花从中翩翩起舞，鸟儿在愉快地歌唱，真可谓是鸟语花香，美极了。我爷爷是个爱花人，每逢春天和夏天花开得最多时，都带我到河边赏花。我们在 花从中流连忘返，像逛花街一样。爷爷在教我认识花的同时，还给我讲“花仙子”等有关花的故事。从儿时起，我就对花有了深厚的感情。 </p>
                          <p>金香河的自然景色令我陶醉，它是我对大自然产生浓厚兴趣的最初地方。我常站在石板桥上，观察河中自然景色的变化。在明媚的春日，我欣赏树木倒映在水中微微跳跃的影子，在深秋的暮色中，我谛听过归鸟的鸣叫声；在雨中，我体验过河面那朦胧、飘缈的意境。清晨，阳光洒满河面，烟雾朝河面散漫开去，河中渐渐明朗，一切都有了新意；黄昏，西坠的太阳柔和的光辉，把满条河映得一片霞红，月下的金香河，更具迷人的特色，温柔的月光铺在河面上，满河银色荡漾。夜阑人静时，聆听柔柔的流水声，宛如一首首田园抒情曲。金香河的景色，孕育了我童年丰富多彩的美术创作题材。我童年的图画本上曾画过早晨的金香河，秋日的金香河和月下的金香河。在一次全镇少年美术大赛上，我创色那幅《晚霞中的金香上》获得了第一名。</p>
                          <p>金香河也给故乡带来过灾难，金香河由于上游支流多，河床狭窄，下游沙泥堵塞，排水量差，加上管理不善，季雨水多时，河水常暴涨。有一年，金香河的水冲垮了堤围，淹没了庄稼，还冲毁了桥梁，给家乡造成巨大的经济损失。</p>
                          <p>我国改革开放后，故乡的人们手头有了钱，他们吸取教训，加强了防洪意识，便集资对金香河进行了综合治理。自此，金香河变成了一条有百益而无一害的河。</p>
                          <p>金香河更美了，但愿金香河永远是一条幸福的河，永远造福于故乡人的子孙万代。</p>

                          `
                         


            },
            {
                id: 3,
                title: "那片青草地",
                excerpt: "居住城市，整天被水泥森林围困着，这使我常常思念那片青草地。",
                image: "https://picsum.photos/400/200?random=4",
                author: "袁会志",
                date: "2021-7-05",
                readTime: "6分钟",
                category: "生活随笔",
                likes: 76,
                content: `<p>居住城市，整天被水泥森林围困着，这使我常常思念那片青草地。</p>
                          <p>那片青草地在村子的南面，面积约干多平方米。草地狭窄细长，远远望去,像一条绿色的毯子铺展在一片高地和水田之间。村子本来就人多地少，梁小姐为何要留着大片草地不种作物？原来，自古村中流传着一个神奇的故事，说什么很久以前那片青草地下住着一条白龙，那龙控制着村子的命脉，龙心情好时，便会风调雨顺；龙心情不好时，便呼风唤雨，作难村子。所以世代以来，没有人敢开垦那块地，怕得罪那龙。因此，那片地就成为了“禁地”。</p>
                          <p>草地有着迷人的诱惑力，像我这样玩皮的孩子，常把大人们的劝告不当一回事，只觉得那神奇的故事是人编出来吓唬人的，于是我们便常常偷偷跑到草地去玩。沿村中大道往前走，穿过一条弯弯曲曲的林中小路，便到了那片神秘的土地。草地很肥沃，长年长着绿茸茸的草，草里头夹着冬种野花。平时，草叶蒙上灰灰的尘土，可是到了春季，细亮的新雨洒过后，那草儿便柔柔软软，生机勃勃。夏天是草地最迷人的季节，各式各样的草一片碧绿，各种花儿竞争开放，山稔的粉红、野玫瑰的淡紫、油菜花的嫩黄等，形成了一幅色彩斑斓的图画，人在其中，有说不出的痛畅，觉得天地万物美好和谐。</p>
                          <p>草地，是我童年的乐园，也是牧牛的好地方。牛在草地里，不会跑去吃庄稼，我们大可放心地去摘山稔果、玩游戏、捉蝴蝶。最有趣的要数捉蜥蜴。蜥蜴喜欢安窝在草地里，洞口椭圆、光滑，易于辨认。蜥蜴的洞一般曲三曲，捉蜥蜴时，先用一根树枝插入洞中，以防它溜走，然后顺着洞的方向挖，便可在洞底捉到它。记得三年级那年的暑假，我们几个孩子疯狂地在草地上挖蜥蜴，把整片土地挖得坑坑洼洼。事后不久，我们的村果然出了一件大事，村子遭受了特大龙卷风的袭击，全村许多房子被毁坏。村子里的长辈们说我们是罪魁祸首，指责我们这些顽皮的孩子不听话，在草地上乱挖乱掘，伤了龙的筋骨，惹龙生气。为此，我们各自被父母痛打了一顿。</p>
                          <p>大人们的指责我们心里虽然不服，但自此之后，我们还是不敢再到草地上去挖掘了。后来我到省城读大学，从此，便远离了那片迷恋的青草地。</p>
                          <p>时光荏苒，阔别多年的那片青草地该是便样了呢？一个阳光明媚的日子，我回到了久别的故乡。十年改革开放，故乡的面貌已发生了很大的变化，宽敞明亮的砖瓦房代替了低矮的茅房，那条弯弯曲曲的村中大路变成了笔直的柏油大道，特别是那片被列为“禁地”的草地已变成了一片绿油油的甘蔗林。乡亲们告诉我，自镇建起了糖厂后，新村长通过大会小会，做群众的思想工作，给大家进科学道理，终干说服了长辈们，同意开垦那草地种蔗。那片草地被开垦后，不但村中平安无事，还给村里带来了好的经济效益。村民们在村长的带领下，日子越过越红火。</p>
                          <p>心中迷恋的那片青草地虽然没有了，但看见那大片的甘蔗林，心里感到更加快慰。</p>
                          `
            },
            {
                id: 4,
                title: "老井",
                excerpt: "故乡那口井已有三百多年历史，因此，当地人称它为老井。",
                image: "https://picsum.photos/400/200?random=5",
                author: "袁会志",
                date: "2020-09-28",
                readTime: "7分钟",
                category: "情感感悟",
                likes: 29,
                content: `<p>故乡那口井已有三百多年历史，因此，当地人称它为老井。</p>
                          <p>故乡的东面临山，山很大，形如雄鹰，村里人把它叫鹰山。鹰山树木浓密，四季常绿。老井就在鹰山脚下。相传，老井原是口山泉，是一老中医发现的。一日，老中医上山采药,突然中暑倒在山下，汩汩的泉水从他身上流过，救了他。为感激救命之恩,他把泉挖成了井，供村民饮用,以作记念。老井不深，却常年有水，有时水还溢出井外。井水清澈透明，水质甘甜,掬一把送进口中，顿觉神情清爽。老井八角形状，井内用青石铺砌，四周有石墙护围，斑剥的墙体上织满了密密的老紫萝藤。井门有一副石刻对联，上下联日:“东郊春暖，井里风和”。井前那条古老的石级小路，像瘦虫一样伸向村子，石级已变得光光滑滑。“文革”期间，造反派毁了那副对联，完整的井从此便残缺不全,失去了当年的风采。</p>
                          <p>小时候，我家离老井很近，拐过一条小巷就到了。爷爷说，我家原来是住在村南的，离井二、三里路，后来为了方便挑水，才搬到这儿来。奶奶说，我家搬到这儿住的另一个原因，是想得到“井神”的保佑。据说那年解放大军南下时，有一千多人的队伍进驻我村，这之前有许多士兵患有一种怪病，身体燥热，皮肤红痒,但饮了我村井水和用井水洗澡后，病症马上消除。他们很感激那井水，后来在那场恶战中，个个杀敌勇猛如虎。村民们认为这是井神的力量，后来都纷纷前往参拜。井使村子出了名,很多人都说此井是神井。后来经科学鉴定，此井的水来自鹰山，含有人体需要的多种元素，对皮肤病有疗效，而并非人们认为的有什么井神。</p>
                          <p>老井那儿是我童年玩得最多、最开心的地方。我爷爷是个勤劳的人，他常去清洁井的卫生，帮助年弱的妇女打水。我常跟爷爷到那儿玩。傍晚是挑水最热闹的时候，妇女们常把井边挤得满满的，辘轳“吱呀呀”不停地响，水一担担被挑走,石级路上，人来人往，充满欢声笑语。在那儿，让人感受到浓浓的乡情。我还从那儿学到不少为人处世的道理。老井旁有一棵古柏树，枝繁叶茂。夏季,村里人爱到树下乘凉。离老井几米远的地方，有只很恭顺的大石龟，光光亮亮。奶奶说它是井的守护神,任何人动它不得，奶奶常常去给石龟烧香。我们小孩全不顾这些，趁大人下田劳动时，骑在石龟上，摇头晃脑,说笑嬉闹。除了玩外，保护井是我们的另一项内容。那时，到外相传有阶级敌人搞破坏，为了防止坏人在井里放毒药，白天，大人们下田劳动时，便叮嘱我们小孩子要提高警惕，干是，我们就像过去的儿童团员那样，在共边站岗放哨。</P>
                          <p>老井历来是村里唯一的食水井，它那甘甜的泉水,喂养了家乡一代又一代的生命，孕育了一代代的人才。爷爷说，解放前，我村出过许多秀才,有的还中进士，在朝廷担任过重要官职。解放后，像我父亲这样的大学生也不少。我村素有“秀才村”之称,在当地很出名。那年我离开故乡外出求学时，老奶奶嘱咐我，以后不管到哪儿工作，都不要忘识村里的老井。</p>
                          <p>老井的水还可灌溉庄稼，有一年，故乡遭受百年未遇的旱情,田地板结龟裂,村民们在采取各种办法都无法解决旱情的情况下，便引用井水灌溉作物。人们原担心会抽干井水，不但于作物无补，人畜也会缺水，想不到，灌溉了作物后，井水一点也没减少</p>
                          <p>岁月匆匆，转眼到了改革开放年代。这些年，家乡发生了巨变。家家户户盖起了新瓦房，有的还盖起新楼房。由于地形原因，新建的房屋离老井越来越远，村民饮水很不方便，于是村子里筹集资金建了水塔，安装了自来水。老井就在 这“哗哗”流淌的自来水声中，与人们渐渐疏远了。但是，它与我们结下了深厚的感情，它将永远留在我们的记忆深处。</p>

                          `
            },

            {
                id: 5,
                title: "游龙虎山",
                excerpt: "从小羡慕大山的我，乘出差之便，在友人的邀约下畅游了有名的风景区龙虎山，圆了多年渴望登山之梦。",
                image: "https://picsum.photos/400/200?random=11",
                author: "袁会志",
                date: "2017-06-22",
                readTime: "7分钟",
                category: "山水游记",
                likes: 30,
                content: `<p>从小羡慕大山的我，乘出差之便，在友人的邀约下畅游了有名的风景区龙虎山，圆了多年渴望登山之梦。</p>
                          <p>龙虎山位于广西隆安县内，距南宁市大约八、九十公里，是国家级自然森林保护区，也是隆安县近年来新开发的一个风景点。深秋一个天色明朗的日子，我们一行五人从南宁乘车往大新线出发，经两个多小时汽车的旅程后，我们终于到达了龙虎山。由于路途弯曲多颠簸，同行的女同志都晕车呕吐，我们稍作休整后便开始爬山。</p>
                          <p>龙虎山由多座透迤连绵的石山组成，那山的形状冬异。龙虎山的山虽不算高，却有峻崖峭壁，兀突石骨。特别是满山郁郁葱葱，层恋叠嶂的树林和奇花异草，更让人陶醉。我们互相牵拉着不断向上攀登，山间峰回路转，左盘右旋。山林中，烂漫山花竞放其间，空气中溢满清香，使人心旷神怡。登上顶峰，驻足山巅，极目远眺，顿觉山之博大、深邃，山气浩渺，无始无穷。置身其间，会感到一种超凡脱俗，仿佛自己已到达一个忘我的境界。</p>
                          <p>游龙虎山，除了领略川的博大、雄峻外，最有趣的便是逗猴。由于该风景区是国家自然森林保护区，所以许多山都有猴子，那猴子保持着原始的野性。当我们进山时，猴子便从山上下来拦路抢食。它们有的吊在路旁的树枝上，伸着长长的手，有的三五成群围在路边，有的则坐在路中间，大有不给食物，休想从这里过去之势。好在我们登山前已准备好猴料，我们分散着给它们食物，它们才放我们过去。过五关斩六将后，我们的猴料所剩无几。听南宁的陶先生讲，猴子是分山头派别的，果然不到二十步，我们又遇上了另一群猴子。因前面已有游客给猴子食物，我们才顺利到达观猴享。亭子周围有许多大石头，是供游客逗猴用的，石头被猴子爬得多了，都变得光滑滑的。在这里，人和猴子可以靠得很近，可以尽情和逗乐。我们把食物抛向猴子身休上下、前后左右不同方向,猴子都很快地接到，那一举手一投足都显得那么机灵。我们趁给猴子食物时，和猴子握手照相。真想不到，山野里的猴子竟能和人配合得那么默契。但猴子也有性起的时候，有一游客为了玩弄猴子，把燃着的烟头丢给猴子，那猴子拾到后以为是食物往嘴里塞，结果被烫得呱呱叫，当那游客第二次丢烟头时，那猴子便跳起来袭击，他幸好他躲得快，不然脸上定会留下疤痕。</P>
                          <p>离开观猴亭，顺着山势往下走，我们到了龙虎山景色最美的地方，这里群山环抱，山峦叠嶂、流水潺潺，有山有水，山牵着水,水依着山，山生锦绣、水淌灵毓。溪旁，一古老水车在悠悠地转动，面前一座造型别致的有色的拱桥凌空飞架，使两边山紧紧相连，举目望去，宛如一道彩虹横在半空，使人赏心悦目。久居喧嚣城市中的我，能拥有这份大白然的美景，真是一种享受。许多游客舍不得这美丽的地方，纷纷择景照相，我们站在水车旁，背对彩虹桥，被永远定格在如诗如画的美景中，作为永久的珍藏。龙虎山虽是被开发的风景区，但大部分地方仍保持着原始的自然风貌，保持着大自然那份神秘感，也许是这样，才吸引着更多的游客。</p>
                          <p>游龙虎山的时间虽然很短，但那山、那水以及有趣的猴子却给我留下深刻记忆。</p>
                          
                          `
            },

             {
                id: 6,
                title: "捕蛇人",
                excerpt: "梅江北岸，有一条百口人家的小村庄，该村三面环山，背面傍水，景色秀美。崎岖的山路上，经常走着一位于执钢钎、身挂竹签的人，他就是当地赫赫有名的捕蛇人阿德。",
                image: "https://picsum.photos/400/200?random=12",
                author: "袁会志",
                date: "2017-08-16",
                readTime: "3分钟",
                category: "生活随笔",
                likes: 8,
                content: `<p>梅江北岸，有一条百口人家的小村庄，该村三面环山，背面傍水，景色秀美。崎岖的山路上，经常走着一位于执钢钎、身挂竹签的人，他就是当地赫赫有名的捕蛇人阿德。</p>
                          <p>阿德在家排行第三，从小失去父亲，母亲含辛茹苦带着他们五个尚未成年的兄妹艰难度日。阿德因小时营养不良，身体弱小，在学校常遭人欺辱，初中没读完便辍学回家放牛。</p>
                          <p>国家改革开放后，村里年青人都外出打工赚钱，阿德因矮小无力，村里的工头不愿带他外出。这伤了阿德的自尊心，他发誓要干出一番事业，让那些看扁他的人瞧瞧。</p>
                          <p>阿德听说邻乡有一捉蛇师父很有本事，捉的蛇能卖许多钱。他觉得干这行很适合自己，于是便前去拜师学技。起初，他跟师父一边捉蛇，一边学艺，不计报酬。阿德学到技术后便离开师父，独自捉蛇。不到两年，阿德练就了一身过硬的捉蛇本领，捉的蛇又大又多，月收入二、三千元。</P>
                          <p>有了钱之后，阿德想到的第一件事是娶个老婆。阿德虽然捉蛇出了名，也有了很多钱。但由于他生得矮小，背有点驼，所以方圆几十里的姑娘也没有一个肯嫁他。后来经媒人撮合，阿德娶了一个年轻寡妇。寡妇还未生过孩子，她嫁给前夫只半年，前夫就出车祸死了，她不算漂亮，但长得结实、丰满，是男人见了都要望几眼的女人。不到四年时间，就给阿德生了两个白胖胖的男孩。</p>
                          <p>生活好过后，阿德三天捉蛇，一天休息。晚上不守老婆，便到村里唯一的杂货店凑热闹。这是男人聚热闹的地方，每天多晚上都有许多人，国事、家事、男女之事、远近新闻晚无所不谈。一次，同村外出做工头的阿旺向大家演说其“风流”故事，说得阿德心痒痒。 一日，阿德挑几条肥蛇到具城宾馆卖，见宾馆里有几个风骚十足的年轻靓女向他眉来眼去，阿德凭感觉知道她们是旺说的那种女人，突然心跳加速，全身燥热，于是在色欲的驱动下，阿德拿卖蛇得来的几百元闯人了“红灯区”。谁知出师不利，他被公安人员当场抓获。</p>
                          <p>几天后，阿德感觉下身痒痛，便去看医生，医生告诉他，是得了性病， 阿德吓了一跳。医生告诚他以后不要碰那些不三不四的女人。阿德很后悔当时因一时冲动，做了蠢事。自己捉蛇几十年，从未被蛇咬过，这次却栽倒在女人身上，不但被罚了款，还染上一身病。“这种女人比蛇还毒。”阿德心里暗暗地说。</p>
                          `
            },

            {
                id: 7,
                title: "老高",
                excerpt: "老高是我校一位有点怪味的语文教师。他真名不叫老高，只因他在我校里最高又最老，我们便习惯称他老高。",
                image: "https://picsum.photos/400/200?random=13",
                author: "袁会志",
                date: "1991-05-16",
                readTime: "6分钟",
                category: "生活随笔",
                likes: 12,
                content: `<p>老高是我校一位有点怪味的语文教师。他真名不叫老高，只因他在我校里最高又最老，我们便习惯称他老高。</p>
                          <p>老高的语文课有点怪味儿。他讲课慢条斯理的，声音温和婉转，犹如一首首甜美的催眠曲，可学生听他的课越听越有神。他很重视他搞的那个“具体、形象化”的教改方法。他说，这是他近十年来用心血换来的研究成果。每上一课他都千方百计想办法找出一些与课文内容有关的具体、形象的实物，结合课文内容对学生进行生动、形象的讲解，从而加深学生对知识的理解。讲到有关蟋蟀的知识，他找来蟋蟀，上到《松鼠》这课，他就托人找来松鼠或有关松鼠生活习惯的挂图，讲到有关植物知识，他或带学生到野外参观,现场上课或亲自到野外采撷。近的地方没有、他必到远的地方去寻找。</p>
                          <p>一次，老高到县城去看病。途中，他看见某种花，正是他下篇课文要讲的那种花，于是不顾重病在身，叫司机停车让他到山上去采，结果摔破头皮，缝了三针。旧病未好，又添新伤，被他老伴骂个狗血淋头。而他还傻笑着说:“缝三针比没有这种花上课好受得多。”气得他老伴有气没处泄。</p>
                          <p>老高很喜欢和学生在起，跟学生真正打成一片。可学生爱唱歌、跳舞，而他不会，无法加进学生的娱乐圈，为此，他几天几夜没吃好睡好。</P>
                          <p>终于，他想出了一个办法，去向年轻的音乐教师学唱歌、跳舞。尽管他年纪大，手脚硬，尽管同行们笑话他；尽管扭伤了腰，他都没有放弃......</p>
                          <p>老高终于学会唱歌、跳舞了。现在，他可以真正和学生们在一起了。老高并非忘记教师的尊严，而是牢记教师的责任，寓教于乐。即使有时歌唱得有头无尾，舞姿生硬，他也乐在其中。老高就是这样一个有点怪味儿的人。</p>
                          
                          `
            },

            {
                id: 8,
                title: "阿烦发财记",
                excerpt: "阿炳是沙湾村一厚道、诚实之人，上有母亲，下有妻儿，一家六口生活重担全落在阿炳身上，生活艰难。",
                image: "https://picsum.photos/400/200?random=14",
                author: "袁会志",
                date: "1991-05-16",
                readTime: "6分钟",
                category: "生活随笔",
                likes: 18,
                content: `<p>阿炳是沙湾村一厚道、诚实之人，上有母亲，下有妻儿，一家六口生活重担全落在阿炳身上，生活艰难。</p>
                          <p>党的十一届三中全会后，阿炳靠勤劳的双手和智慧与妻子一起耕种养畜，生活倒也过得丰裕。在当时沙湾村中，阿炳生活算得上是数一、数二的，为此，阿炳曾自豪过好些日子一日。</p>
                          <p>在外搞建筑工的邻居梁伯的儿子阿才从深圳回来，带回了冰箱、大彩电、收录机。阿才告诉村里人，在外打工搵钱易如掘金，生活灯红酒绿，真是羡煞不少人，阿才还同意带村里人出外捞世界。于是小小的山村骚动了，全村 90%的男人都跟着阿才跑了，阿炳因要照顾年老多病的母亲，只得留村躬耕了。几年后，那一群出外打工的男人回来了，个个穿金戴银，神气十足。不久，一些人便在村上建起了小楼房，阿才出入也有了小轿车，真是洒尽了威风。阿炳和他们相比，真是天壤之别。想当年，阿炳在村上还是一首富，可现在却成了倒数的贫困户，这深深地刺痛了阿炳的自尊心，他越想越怨气。</p>
                          <p>已好几天没见阿炳出门了，人们担心阿炳是不是气病了。其实不然，阿炳只不过是闭门躺在床上想着发财路。阿炳想：既然不能走金光大道，为什么不能走独木桥呢？阿炳于是和妻子做起了生意，在村口开了间杂货店。由于货真价实，经营有方，很快便有了市场，早、晚常常门庭若市。生意虽小，可几年下来，阿炳还是积蓄了好几万元。但阿炳一想到阿才他们，便常不服气，一心想超过他们。</P>
                          <p>听人说，干走私货能赚大钱，阿炳经不住金钱的诱惑，终于与朋友合伙走私香烟，结果被公安部门查获，血本无归，气得妻子要跳河寻短见。</p>
                          <p>经此巨变，阿炳终于领悟到，靠走私赚大钱的生意，并不是一条实在的生财之道，只有脚踏实地、才能心安理得地发财</p>
                          
                          `
            },

             {
                id: 9,
                title: "爱真情真的魅力",
                excerpt: "前两年台湾亲情片《妈妈再爱我一次》在我国上映曾引起一片轰动， 感动了无数观众 ，但若与《疯女泪》相比还是略逊一筹。",
                image: "https://picsum.photos/400/200?random=15",
                author: "袁会志",
                date: "1991-05-16",
                readTime: "6分钟",
                category: "读书心得",
                likes: 63,
                content: `<p>前两年台湾亲情片《妈妈再爱我一次》在我国上映曾引起一片轰动， 感动了无数观众 ，但若与《疯女泪》相比还是略逊一筹。</p>
                          <p>《妈妈再爱我一次》和《疯女泪》都是反映善良妈女悲惨命运，悲惨生活的故事。但《疯女泪》故事更动人。它通过月里一生悲惨遭遇的描述，突比塑造了一位忍辱负重，无私奉南的继母的高大形象，讴歌了月里这个典型女性人情美、人性美。景片剧情波澜起伏， 随着小慧“妈妈再抱我一次”嘶声力竭的哭喊和传宗忏悔着哭叫这个自己从来不把她当作母亲的【妈妈】，形成两次悲剧高潮，使人潸然泪下。该片无论是故事情节，故事内容都比《妈妈再爱我一次》复杂，感人。</p>
                          <p>《妈妈再爱我一次》反映的是爱子之心母子之情，人皆有之，带有社会普遍性。而《疯女泪》则在情字上面突破一个深的层次。该片除了陈述母子情外，还突出抒写了婆媳情、母女情、夫妻情，这种情，这种爱是真诚的、博大的、深沉的。无论婆婆怎样歧视，辱待月里， 甚至要把她卖掉，她对婆婆的爱和情都是真挚的，没有改变的。为治好婆婆的病，她忍着巨大的悲痛卖掉了自己心爱的女儿小慧，甚至还害下自已身上肉给婆婆煎药。对传宗，也不因传宗不是她生的而虐待他，而是把他当作亲生儿一样对待。她不是一个因失去丈夫，婆婆对她不好，就轻易改嫁的女人。她对丈夫的爱是真挚的，忠贞不渝的。透过一幅幅动人悲壮的画面。我们不难发现，这个具有中华民族传统美德的女性身上蕴藏的心灵美、人情美和人性美。</p>
                          <p>已好几天没见阿炳出门了，人们担心阿炳是不是气病了。其实不然，阿炳只不过是闭门躺在床上想着发财路。阿炳想：既然不能走金光大道，为什么不能走独木桥呢？阿炳于是和妻子做起了生意，在村口开了间杂货店。由于货真价实，经营有方，很快便有了市场，早、晚常常门庭若市。生意虽小，可几年下来，阿炳还是积蓄了好几万元。但阿炳一想到阿才他们，便常不服气，一心想超过他们。</P>
                          <p>《妈妈再爱我一次》虽然能博得观众的眼泪，但它只是人为地编造出的一出悲剧，擦干眼泪后没有多大的收获， 它缺乏深沉的理性张力。 而《疯女泪》则以爱真、情真打动人。影片以情生戏，以戏生情，使人看后引起震动和深思，它尤如咀嚼一枚青橄，留给人们的回味是隽永的，启迪是深邀的。</p>
                          
                          `
            },

            {
                id: 10,
                title: "如梦的步履",
                excerpt: "步履在秋光争宠的时空中蹒跚，沉淀成一摞摞厚重的日记。",
                image: "https://picsum.photos/400/200?random=16",
                author: "袁会志",
                date: "1996-03-16",
                readTime: "6分钟",
                category: "散文诗集",
                likes: 56,
                content: `<p>步履在秋光争宠的时空中蹒跚，沉淀成一摞摞厚重的日记。</p>
                          <p>流浪的心已装不下半分负载。春去秋来每次生命都经历着同样的归程。走过的日子路已模糊，灵光在光阴的飞逝中微弱。</p>
                          <p>忘了日子长在土里。找一个遗忘的角落，站在似熟非熟的痛苦里，让所有的过去种植成荫，在宁静的夏夜，咀嚼感受。</p>
                          <p>打开窗口，让心灵歌唱。摘一缕童心的真诚，透视天镜中那一盘崭新的火球。</P>
                          
                          
                          `
            },

            {
                id: 11,
                title: "风雨站台",
                excerpt: "在多情的雨夜里，遥想漂泊的你。那扇紧闭的窗口，洒进一缕清辉，泛起层层涟漪。。",
                image: "https://picsum.photos/400/200?random=17",
                author: "袁会志",
                date: "1997-03-21",
                readTime: "2分钟",
                category: "散文诗集",
                likes: 19,
                content: `<p>在多情的雨夜里，遥想漂泊的你。那扇紧闭的窗口，洒进一缕清辉，泛起层层涟漪。</p>
                          <p>曾与你相依走在风雨中，看天际美丽的翅膀，数长长的柳丝。梧桐树下,你那双玫瑰色的火焰，点燃一个个夏天的故事....是你，执着地对我微笑，是你，温暖我这颗冰冷的心，让我们共同缝制一个迷蒙而美丽的梦境。</p>
                          <p>你走后的日子，我的思念在风雨的叹息中灌溉滋生。酒杯内外，你总与我咫尺相隔。</p>
                          <p>孤独的心绪在雨幕中徘徊，颤抖着滴滴痛楚的血泪，多情的回忆聚涌心头，终于悔恨自己不该撕散那片爱的诗意。踏过雨季黄昏,回首每一道门槛,等你在风雨中,盼你成一首小诗踏歌而来。</P>
                                       
                          `
            },

            {
                id: 12,
                title: "远方的乎唤",
                excerpt: "在无数个寂寥清风的日子里，总感到远方有一声呼唤，那么迫切、那么热情。",
                image: "https://picsum.photos/400/200?random=18",
                author: "袁会志",
                date: "1997-03-21",
                readTime: "2分钟",
                category: "散文诗集",
                likes: 23,
                content: `<p>在无数个寂寥清风的日子里，总感到远方有一声呼唤，那么迫切、那么热情。</p>
                          <p>希望的船，几经波涛的撞击，仍没有破碎。调整航向，信念又滑向远方。</p>
                          <p>越过千重寂寞的浪，吞下太多的涩果，终于才明白远方是个沉重的主题。</p>
                          <p>远方是否美丽,未来是否洒脱人生，这无关紧要，只有那一声呼唤，就足以鼓起扬帆的的勇气。</P>
                                                   
                          `
            },

             {
                id: 13,
                title: "蓝色槽歌",
                excerpt: "橘子花开满山坡的夜晚，潮水溅湿了梦呓。",
                image: "https://picsum.photos/400/200?random=19",
                author: "袁会志",
                date: "1999-09-28",
                readTime: "2分钟",
                category: "散文诗集",
                likes: 20,
                content: `<p>橘子花开满山坡的夜晚，潮水溅湿了梦呓。</p>
                          <p>穿透渔家点点灯火，心绪浮于波纹繁杂的水面。淡淡的月光下，一叶小舟划向呢喃的季节，在深沉里播下希望的种子。奖声阵阵，信念如初。</p>
                          <p>彼岸，有蓝色的撸歌滚滚而来，如奋进的号角，在我心头荡起阵阵激情。缤纷的心蓦然开放，碧波万顷的心海漂着一叶小舟。</p>
                          <p>踏着歌声，用一支浆摇摆着求索的人生。</P>
                                                  
                          `
            },

            {
                id: 14,
                title: "子夜听歌",
                excerpt: "夜。月光如水，夜露轻漫。",
                image: "https://picsum.photos/400/200?random=20",
                author: "袁会志",
                date: "2022-03-28",
                readTime: "2分钟",
                category: "散文诗集",
                likes: 16,
                content: `<p>夜。月光如水，夜露轻漫。</p>
                          <p>半扇小窗，盛满亮色。窗外，一片白色的岁月上，清风缠绵着遥远的相思，月光抚慰着心灵，使生命拥有一刻最真实的宁静。</p>
                          <p>子夜的惠风，让我感受一枝枝依依杨柳的风韵，一丝草地野花的芬芳，一池温泉柔水的爱情。</p>
                          <p>夜阑人静，有歌声穿过季节的帷幔。竹笛的旋律里，碎落的故事哀婉典雅，似有天涯赤子思亲的秋意。谁的心事春水一般盈溢，春草一般蔓延？情牵故土的歌声，穿透我的心，犹如慈母声声的低唤。一段脆弱的往事,断不了思乡的枝条，背井离乡的岁月，总有思结连绵的夜色。</P>
                          <p>轻轻地，洁白的月色明亮起我鲜嫩的心情。四季风景中，有一条路伸过来，带我朝一轮满月里走。披一肩千古月华,唱一首家乡的谣曲，在那片纯洁古老的大地上，刻下秋的写意。</p> 
                         
                          `
            },

            {
                id: 15,
                title: "留下纯真的爱",
                excerpt: "从回校的那天起，我就在努力寻觅，寻觅那个曾给予我那份纯情那份关注的女孩。。",
                image: "https://picsum.photos/400/200?random=21",
                author: "袁会志",
                date: "1992-036-18",
                readTime: "分钟",
                category: "散文诗集",
                likes: 15,
                content: `<p>从回校的那天起，我就在努力寻觅，寻觅那个曾给予我那份纯情那份关注的女孩。</p>
                          <p>我猜想，此时的她，一定会如一朵淡雅的小花，在春天中露出鹅黄色的微笑。可无论我怎样地寻找，都无法再见到那个可爱的她，无法见到她那个甜甜的爪子脸，那双漆黑有神的眼睛，那头短短的黑发。</p>
                          <p>听同事说，她走了，走得很洒脱，走得很壮烈。人们怨恨那个不会重复的夏天，那辆该死的车，那个不该出现的小男孩。然而，这一切都不可避免地出现了。汽车从她年轻的身躯上辗过，路上散落点点腥红的花瓣。此时，我无法描述一个十六岁的女孩，为救路边贪玩的小孩那震撼人心的壮举。</p>
                          <p>窗外，雨点打着树叶，沙沙作响。校园里弥漫着寂寞的氛围。</P>
                          <p>她那身影又浮现在眼前，那银铃般的声音又回荡在耳边。缠绵的雨天，她给我送来温情，送来关注。那把红红的小伞尽是倾斜于我，而无情的雨却打湿了她的秀发。她为我撑起的小伞,酿造出温馨的晴朗......</p> 
                          <p>回首的时刻，是一杯苦涩的酒。</p>
                          <p>伸向校园的小路还在，一切依旧，唯独不见她的身影—— 一个年年“三好学生、”常帮助小同学的少女。但她的那份纯真，那份善良，那一片给人以爱的心羽，将刻在我心灵的底片上，刻在人们永恒的思念中。</p>
                          `
            },
        ];

        // 用户数据 - 从localStorage获取，若无则初始化空数组
        let users = JSON.parse(localStorage.getItem('users')) || [];
        // 当前登录用户
        let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;

        // 评论数据 - 从localStorage获取，若无则初始化空数组
        let comments = JSON.parse(localStorage.getItem('comments')) || [];

        // 点赞数据 - 从localStorage获取，若无则初始化空对象
        let likes = JSON.parse(localStorage.getItem('likes')) || {};

        // 收藏数据 - 从localStorage获取，若无则初始化空对象
        let bookmarks = JSON.parse(localStorage.getItem('bookmarks')) || {};

        // 画廊图片数据
        const galleryImages = [
            "https://picsum.photos/800/400?random=6",
            "https://picsum.photos/800/400?random=7",
            "https://picsum.photos/800/400?random=8",
            "https://picsum.photos/800/400?random=9",
            "https://picsum.photos/800/400?random=10"
        ];

        // 适合散文的随机图片分类关键词
        const 散文意境图片分类 = [
            "nature", "landscape", "autumn", "spring", "garden", 
            "mountains", "rivers", "sunset", "rain", "snow",
            "forest", "library", "books", "ink", "calligraphy"
        ];

        // 初始化变量
        let currentSlide = 0;
        let imagePreviewUrl = null;
        let currentArticleId = null;
        let currentCategory = "all";
        let currentSearchTerm = ""; // 新增：当前搜索词
        // 获取主要区域元素
        const publishSection = document.getElementById('publish');
        const articlesSection = document.getElementById('articles');
        const articleDetailSection = document.getElementById('articleDetail');
        const bookmarksSection = document.getElementById('bookmarks');

        // DOM 加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化用户相关功能
            initUserFunctions();
            
            // 初始化分类筛选
            initCategories();
            
            // 初始化搜索功能 - 新增
            initSearchFunction();
            
            // 初始化发布文章显示/隐藏功能
            const publishToggle = document.getElementById('publishToggle');
            
            // 点击按钮显示/隐藏发布文章区域
            publishToggle.addEventListener('click', function() {
                // 检查是否登录
                if (!currentUser) {
                    showAuthModal();
                    showSuccessMessage("请先登录后再发布文章");
                    return;
                }
                
                // 隐藏其他区域，显示发布区域
                articlesSection.style.display = 'block';
                articleDetailSection.style.display = 'none';
                bookmarksSection.style.display = 'none';
                
                // 切换发布区域显示状态
                if (publishSection.style.display === 'none' || publishSection.style.display === '') {
                    publishSection.style.display = 'block';
                    // 滚动到发布区域
                    publishSection.scrollIntoView({
                        behavior: 'smooth'
                    });
                } else {
                    publishSection.style.display = 'none';
                }
                
                // 如果是移动端，点击后关闭菜单
                const navMenu = document.querySelector('.nav-menu');
                if (navMenu.classList.contains('active')) {
                    navMenu.classList.remove('active');
                }
            });

            // 其他初始化
            initializeNavbar();
            loadArticles();
            initializeGallery();
            setupPublishForm();
            setupCommentForm();
        });

        // 初始化搜索功能 - 新增
        function initSearchFunction() {
            const searchInput = document.getElementById('searchInput');
            const searchResultsInfo = document.getElementById('searchResultsInfo');
            
            // 搜索输入事件
            searchInput.addEventListener('input', function() {
                // 去除首尾空格并转为小写
                currentSearchTerm = this.value.trim().toLowerCase();
                
                // 重新加载文章，应用搜索筛选
                loadArticles();
                
                // 显示搜索结果提示
                if (currentSearchTerm) {
                    // 计算符合条件的文章数量
                    const filteredArticles = filterArticlesBySearchAndCategory();
                    searchResultsInfo.textContent = `找到 ${filteredArticles.length} 篇包含"${this.value}"的文章`;
                    searchResultsInfo.style.display = 'block';
                } else {
                    // 没有搜索词时隐藏提示
                    searchResultsInfo.style.display = 'none';
                }
            });
            
            // 回车提交搜索
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    // 失去焦点，隐藏键盘
                    this.blur();
                }
            });
        }

        // 按搜索词和分类筛选文章 - 新增
        function filterArticlesBySearchAndCategory() {
            let filteredArticles = articles;
            
            // 先应用分类筛选
            if (currentCategory !== 'all' && currentCategory) {
                filteredArticles = filteredArticles.filter(article => article.category === currentCategory);
            }
            
            // 再应用搜索筛选
            if (currentSearchTerm) {
                filteredArticles = filteredArticles.filter(article => {
                    // 搜索标题、摘要、作者和内容
                    return article.title.toLowerCase().includes(currentSearchTerm) ||
                           article.excerpt.toLowerCase().includes(currentSearchTerm) ||
                           article.author.toLowerCase().includes(currentSearchTerm) ||
                           article.content.toLowerCase().includes(currentSearchTerm);
                });
            }
            
            return filteredArticles;
        }

        // 初始化用户功能
        function initUserFunctions() {
            const userBtn = document.getElementById('userBtn');
            const userDropdown = document.getElementById('userDropdown');
            const userMenuText = document.getElementById('userMenuText');
            const profileItem = document.getElementById('profileItem');
            const bookmarksItem = document.getElementById('bookmarksItem');
            const logoutItem = document.getElementById('logoutItem');
            const authModal = document.getElementById('authModal');
            const authTabs = document.querySelectorAll('.auth-tab');
            const authForms = document.querySelectorAll('.auth-form');
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');

            // 更新用户菜单显示
            updateUserMenu();
            
            // 用户菜单点击事件
            userBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                // 如果未登录，显示登录模态框
                if (!currentUser) {
                    showAuthModal();
                } else {
                    // 如果已登录，显示下拉菜单
                    userDropdown.classList.toggle('active');
                }
            });
            
            // 点击页面其他地方关闭下拉菜单
            document.addEventListener('click', function() {
                userDropdown.classList.remove('active');
            });
            
            // 个人中心
            profileItem.addEventListener('click', function() {
                showProfileModal();
                userDropdown.classList.remove('active');
            });
            
            // 我的收藏
            bookmarksItem.addEventListener('click', function() {
                showBookmarks();
                userDropdown.classList.remove('active');
            });
            
            // 退出登录
            logoutItem.addEventListener('click', function() {
                currentUser = null;
                localStorage.removeItem('currentUser');
                updateUserMenu();
                userDropdown.classList.remove('active');
                showSuccessMessage("已成功退出登录");
                // 刷新文章列表，更新点赞收藏状态
                loadArticles();
            });
            
            // 切换登录/注册标签
            authTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // 更新标签样式
                    authTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新表单显示
                    authForms.forEach(form => form.classList.remove('active'));
                    document.getElementById(`${tabName}Form`).classList.add('active');
                    
                    // 清除错误信息
                    document.querySelectorAll('.error-message').forEach(el => {
                        el.classList.remove('show');
                    });
                });
            });
            
            // 登录表单提交
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('loginUsername').value;
                const password = document.getElementById('loginPassword').value;
                const userError = document.getElementById('loginUserError');
                const pwdError = document.getElementById('loginPwdError');
                
                // 清除之前的错误
                userError.classList.remove('show');
                pwdError.classList.remove('show');
                
                // 查找用户
                const user = users.find(u => u.username === username);
                
                if (!user) {
                    userError.textContent = "用户名不存在";
                    userError.classList.add('show');
                    return;
                }
                
                if (user.password !== password) {
                    pwdError.textContent = "密码不正确";
                    pwdError.classList.add('show');
                    return;
                }
                
                // 登录成功
                currentUser = user;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                closeAuthModal();
                updateUserMenu();
                showSuccessMessage("登录成功");
                // 刷新文章列表，更新点赞收藏状态
                loadArticles();
            });
            
            // 注册表单提交
            registerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('regUsername').value;
                const password = document.getElementById('regPassword').value;
                const confirmPassword = document.getElementById('regConfirmPassword').value;
                const userError = document.getElementById('regUserError');
                const pwdError = document.getElementById('regPwdError');
                const confirmError = document.getElementById('regConfirmError');
                
                // 清除之前的错误
                userError.classList.remove('show');
                pwdError.classList.remove('show');
                confirmError.classList.remove('show');
                
                // 验证用户名
                if (username.length < 3) {
                    userError.textContent = "用户名长度至少3个字符";
                    userError.classList.add('show');
                    return;
                }
                
                // 检查用户名是否已存在
                if (users.some(u => u.username === username)) {
                    userError.textContent = "用户名已存在";
                    userError.classList.add('show');
                    return;
                }
                
                // 验证密码
                if (password.length < 6) {
                    pwdError.textContent = "密码长度至少6个字符";
                    pwdError.classList.add('show');
                    return;
                }
                
                // 验证确认密码
                if (password !== confirmPassword) {
                    confirmError.textContent = "两次输入的密码不一致";
                    confirmError.classList.add('show');
                    return;
                }
                
                // 注册成功，创建新用户
                const today = new Date();
                const joinDate = today.getFullYear() + '-' + 
                               String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                               String(today.getDate()).padStart(2, '0');
                
                const newUser = {
                    id: users.length + 1,
                    username: username,
                    password: password,
                    joinDate: joinDate
                };
                
                users.push(newUser);
                localStorage.setItem('users', JSON.stringify(users));
                
                // 自动登录
                currentUser = newUser;
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                closeAuthModal();
                updateUserMenu();
                showSuccessMessage("注册成功，已自动登录");
            });
        }
        
        // 更新用户菜单显示
        function updateUserMenu() {
            const userMenuText = document.getElementById('userMenuText');
            const commentAuthor = document.getElementById('commentAuthor');
            const commentContent = document.getElementById('commentContent');
            
            if (currentUser) {
                // 已登录状态
                userMenuText.textContent = currentUser.username;
                // 启用评论框
                commentAuthor.disabled = false;
                commentAuthor.value = currentUser.username;
                commentContent.disabled = false;
            } else {
                // 未登录状态
                userMenuText.textContent = "登录";
                // 禁用评论框
                commentAuthor.disabled = true;
                commentAuthor.value = "";
                commentContent.disabled = true;
            }
        }
        
        // 显示登录注册模态框
        function showAuthModal() {
            document.getElementById('authModal').style.display = 'flex';
            // 重置表单
            document.getElementById('loginForm').reset();
            document.getElementById('registerForm').reset();
            // 清除错误信息
            document.querySelectorAll('.error-message').forEach(el => {
                el.classList.remove('show');
            });
        }
        
        // 关闭登录注册模态框
        function closeAuthModal() {
            document.getElementById('authModal').style.display = 'none';
        }
        
        // 显示个人中心模态框
        function showProfileModal() {
            if (!currentUser) return;
            
            document.getElementById('usernameDisplay').textContent = currentUser.username;
            document.getElementById('joinDate').textContent = currentUser.joinDate;
            
            // 显示用户头像（使用用户名首字母）
            const firstChar = currentUser.username.charAt(0).toUpperCase();
            document.getElementById('userAvatar').innerHTML = `<span>${firstChar}</span>`;
            
            // 加载我的文章
            const myArticlesContainer = document.getElementById('myArticlesContainer');
            const myArticles = articles.filter(article => article.author === currentUser.username);
            
            if (myArticles.length === 0) {
                myArticlesContainer.innerHTML = "<p>您还没有发布任何文章</p>";
            } else {
                let html = "<ul style='padding-left: 1.5rem;'>";
                myArticles.forEach(article => {
                    html += `<li><a href="#" onclick="showArticleDetail(${article.id}); closeModal(); return false;">${article.title}</a></li>`;
                });
                html += "</ul>";
                myArticlesContainer.innerHTML = html;
            }
            
            document.getElementById('profileModal').style.display = 'flex';
        }
        
        // 显示我的收藏
        function showBookmarks() {
            if (!currentUser) {
                showAuthModal();
                showSuccessMessage("请先登录后查看收藏");
                return;
            }
            
            // 隐藏其他区域，显示收藏区域
            articlesSection.style.display = 'none';
            articleDetailSection.style.display = 'none';
            publishSection.style.display = 'none';
            bookmarksSection.style.display = 'block';
            
            const bookmarksGrid = document.getElementById('bookmarksGrid');
            // 获取当前用户的收藏
            const userBookmarks = bookmarks[currentUser.id] || [];
            // 获取收藏的文章
            const bookmarkedArticles = articles.filter(article => 
                userBookmarks.includes(article.id)
            );
            
            if (bookmarkedArticles.length === 0) {
                bookmarksGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-bookmark"></i>
                        <h3>暂无收藏</h3>
                        <p>快去收藏喜欢的文章吧</p>
                        <button class="cta-button" style="margin-top: 1rem;" onclick="showArticlesList()">浏览文章</button>
                    </div>
                `;
                return;
            }
            
            // 渲染收藏的文章
            bookmarksGrid.innerHTML = '';
            bookmarkedArticles.forEach(article => {
                const isLiked = currentUser && likes[currentUser.id] && likes[currentUser.id].includes(article.id);
                const isBookmarked = currentUser && bookmarks[currentUser.id] && bookmarks[currentUser.id].includes(article.id);
                
                const card = document.createElement('div');
                card.className = 'article-card';
                card.innerHTML = `
                    <div class="article-image-container">
                        <span class="article-category">${article.category}</span>
                        <img src="${article.image}" alt="${article.title}" class="article-image">
                    </div>
                    <div class="article-content">
                        <h4 class="article-title">${article.title}</h4>
                        <p class="article-excerpt">${article.excerpt}</p>
                        <div class="article-actions">
                            <button class="action-btn ${isLiked ? 'liked' : ''}" onclick="toggleLike(event, ${article.id})">
                                <i class="fas fa-heart"></i>
                                <span>${article.likes || 0}</span>
                            </button>
                            <button class="action-btn ${isBookmarked ? 'bookmarked' : ''}" onclick="toggleBookmark(event, ${article.id})">
                                <i class="fas fa-bookmark"></i>
                                <span>收藏</span>
                            </button>
                        </div>
                        <div class="article-meta">
                            <span>${article.author}</span>
                            <span>${article.date}</span>
                            <span>${article.readTime}</span>
                        </div>
                    </div>
                `;
                
                // 添加点击事件，打开文章详情
                card.addEventListener('click', function(e) {
                    // 避免点击按钮时触发卡片点击事件
                    if (!e.target.closest('.action-btn')) {
                        showArticleDetail(article.id);
                    }
                });
                
                bookmarksGrid.appendChild(card);
            });
            
            // 滚动到收藏区域
            bookmarksSection.scrollIntoView({
                behavior: 'smooth'
            });
        }

        // 初始化分类筛选
        function initCategories() {
            const categoriesFilter = document.getElementById('categoriesFilter');
            
            // 添加分类按钮
            categories.forEach(category => {
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.setAttribute('data-category', category);
                btn.textContent = category;
                
                btn.addEventListener('click', function() {
                    // 更新活跃状态
                    document.querySelectorAll('.category-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // 筛选文章
                    currentCategory = this.getAttribute('data-category');
                    loadArticles();
                });
                
                categoriesFilter.appendChild(btn);
            });
            
            // 为"全部"按钮添加点击事件
            document.querySelector('.category-btn[data-category="all"]').addEventListener('click', function() {
                // 更新活跃状态
                document.querySelectorAll('.category-btn').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
                
                // 筛选文章 - 显示全部文章
                currentCategory = "all";
                loadArticles();
            });
        }

        // 导航栏功能
        function initializeNavbar() {
            const navToggle = document.querySelector('.nav-toggle');
            const navMenu = document.querySelector('.nav-menu');

            navToggle.addEventListener('click', function() {
                navMenu.classList.toggle('active');
            });

            // 平滑滚动
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    
                    // 如果点击的是文章列表链接
                    if (targetId === '#articles') {
                        e.preventDefault();
                        showArticlesList();
                    }
                    
                    // 其他链接的默认处理
                    if (this.getAttribute('href') !== '#articles') {
                        e.preventDefault();
                        const targetSection = document.querySelector(targetId);
                        if (targetSection) {
                            // 显示对应区域，隐藏其他区域
                            articlesSection.style.display = 'block';
                            articleDetailSection.style.display = 'none';
                            publishSection.style.display = 'none';
                            bookmarksSection.style.display = 'none';
                            
                            window.scrollTo({
                                top: targetSection.offsetTop - 70,
                                behavior: 'smooth'
                            });
                        }
                    }
                    
                    // 移动端点击后关闭菜单
                    if (navMenu.classList.contains('active')) {
                        navMenu.classList.remove('active');
                    }
                });
            });
        }

        // 加载文章列表 - 集成搜索功能
        function loadArticles() {
            const articlesGrid = document.getElementById('articlesGrid');
            articlesGrid.innerHTML = ''; // 清空现有内容
            
            // 应用搜索和分类筛选
            const filteredArticles = filterArticlesBySearchAndCategory();
            
            if (filteredArticles.length === 0) {
                // 显示无结果提示
                let message = "暂无文章";
                if (currentSearchTerm) {
                    message = `没有找到包含"${currentSearchTerm}"的文章`;
                } else if (currentCategory !== 'all') {
                    message = `该分类下暂无文章`;
                }
                
                articlesGrid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-file-alt"></i>
                        <h3>${message}</h3>
                        ${currentSearchTerm ? `<button class="cta-button" style="margin-top: 1rem;" onclick="clearSearch()">清除搜索</button>` : ''}
                    </div>
                `;
                return;
            }
            
            filteredArticles.forEach(article => {
                const isLiked = currentUser && likes[currentUser.id] && likes[currentUser.id].includes(article.id);
                const isBookmarked = currentUser && bookmarks[currentUser.id] && bookmarks[currentUser.id].includes(article.id);
                
                // 高亮搜索关键词 - 新增
                let highlightedTitle = highlightSearchTerm(article.title);
                let highlightedExcerpt = highlightSearchTerm(article.excerpt);
                
                const card = document.createElement('div');
                card.className = 'article-card';
                card.innerHTML = `
                    <div class="article-image-container">
                        <span class="article-category">${article.category}</span>
                        <img src="${article.image}" alt="${article.title}" class="article-image">
                    </div>
                    <div class="article-content">
                        <h4 class="article-title">${highlightedTitle}</h4>
                        <p class="article-excerpt">${highlightedExcerpt}</p>
                        <div class="article-actions">
                            <button class="action-btn ${isLiked ? 'liked' : ''}" onclick="toggleLike(event, ${article.id})">
                                <i class="fas fa-heart"></i>
                                <span>${article.likes || 0}</span>
                            </button>
                            <button class="action-btn ${isBookmarked ? 'bookmarked' : ''}" onclick="toggleBookmark(event, ${article.id})">
                                <i class="fas fa-bookmark"></i>
                                <span>收藏</span>
                            </button>
                        </div>
                        <div class="article-meta">
                            <span>${article.author}</span>
                            <span>${article.date}</span>
                            <span>${article.readTime}</span>
                        </div>
                    </div>
                `;
                
                // 添加点击事件，打开文章详情
                card.addEventListener('click', function(e) {
                    // 避免点击按钮时触发卡片点击事件
                    if (!e.target.closest('.action-btn')) {
                        showArticleDetail(article.id);
                    }
                });
                
                articlesGrid.appendChild(card);
            });
        }

        // 高亮搜索关键词 - 新增
        function highlightSearchTerm(text) {
            if (!currentSearchTerm) {
                return text;
            }
            
            // 转义特殊字符，避免正则表达式错误
            const escapedTerm = currentSearchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(`(${escapedTerm})`, 'gi');
            
            // 使用<span>标签包裹匹配的关键词，添加高亮样式
            return text.replace(regex, '<span style="background-color: #fff3cd; font-weight: bold;">$1</span>');
        }

        // 清除搜索 - 新增
        function clearSearch() {
            const searchInput = document.getElementById('searchInput');
            const searchResultsInfo = document.getElementById('searchResultsInfo');
            
            searchInput.value = '';
            currentSearchTerm = '';
            searchResultsInfo.style.display = 'none';
            
            // 重新加载文章
            loadArticles();
        }

        // 切换点赞状态
        function toggleLike(event, articleId) {
            event.stopPropagation();
            
            // 检查是否登录
            if (!currentUser) {
                showAuthModal();
                showSuccessMessage("请先登录后再点赞");
                return;
            }
            
            const article = articles.find(a => a.id === articleId);
            if (!article) return;
            
            // 初始化用户点赞数据
            if (!likes[currentUser.id]) {
                likes[currentUser.id] = [];
            }
            
            const userLikes = likes[currentUser.id];
            const isLiked = userLikes.includes(articleId);
            
            if (isLiked) {
                // 取消点赞
                likes[currentUser.id] = userLikes.filter(id => id !== articleId);
                article.likes = (article.likes || 0) - 1;
            } else {
                // 点赞
                userLikes.push(articleId);
                article.likes = (article.likes || 0) + 1;
            }
            
            // 保存数据
            localStorage.setItem('likes', JSON.stringify(likes));
            localStorage.setItem('articles', JSON.stringify(articles));
            
            // 更新UI
            if (currentArticleId === articleId) {
                // 如果在详情页，更新详情页的点赞状态
                updateDetailLikeStatus();
            } else {
                // 否则更新列表
                loadArticles();
                // 如果在收藏页，也更新收藏页
                if (bookmarksSection.style.display === 'block') {
                    showBookmarks();
                }
            }
        }

        // 切换收藏状态
        function toggleBookmark(event, articleId) {
            event.stopPropagation();
            
            // 检查是否登录
            if (!currentUser) {
                showAuthModal();
                showSuccessMessage("请先登录后再收藏");
                return;
            }
            
            // 初始化用户收藏数据
            if (!bookmarks[currentUser.id]) {
                bookmarks[currentUser.id] = [];
            }
            
            const userBookmarks = bookmarks[currentUser.id];
            const isBookmarked = userBookmarks.includes(articleId);
            
            if (isBookmarked) {
                // 取消收藏
                bookmarks[currentUser.id] = userBookmarks.filter(id => id !== articleId);
                showSuccessMessage("已取消收藏");
            } else {
                // 收藏
                userBookmarks.push(articleId);
                showSuccessMessage("收藏成功");
            }
            
            // 保存数据
            localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
            
            // 更新UI
            if (currentArticleId === articleId) {
                // 如果在详情页，更新详情页的收藏状态
                updateDetailBookmarkStatus();
            } else {
                // 否则更新列表
                loadArticles();
                // 如果在收藏页，也更新收藏页
                if (bookmarksSection.style.display === 'block') {
                    showBookmarks();
                }
            }
        }

        // 显示文章详情
        function showArticleDetail(articleId) {
            // 隐藏列表，显示详情
            articlesSection.style.display = 'none';
            publishSection.style.display = 'none';
            bookmarksSection.style.display = 'none';
            articleDetailSection.style.display = 'block';
            
            // 记录当前文章ID
            currentArticleId = articleId;
            
            // 查找对应的文章
            const article = articles.find(a => a.id === articleId);
            if (article) {
                // 填充详情页内容
                document.getElementById('detailCategory').textContent = article.category;
                document.getElementById('detailTitle').textContent = article.title;
                document.getElementById('detailMeta').textContent = 
                    `${article.author} | ${article.date} | ${article.readTime}`;
                document.getElementById('detailImage').src = article.image;
                document.getElementById('detailImage').alt = article.title;
                
                // 高亮详情页中的搜索关键词 - 新增
                let highlightedContent = article.content;
                if (currentSearchTerm) {
                    const escapedTerm = currentSearchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    const regex = new RegExp(`(${escapedTerm})`, 'gi');
                    highlightedContent = highlightedContent.replace(regex, '<span style="background-color: #fff3cd; font-weight: bold;">$1</span>');
                }
                document.getElementById('detailContent').innerHTML = highlightedContent;
                
                document.getElementById('likeCount').textContent = `(${article.likes || 0})`;
                
                // 更新点赞和收藏状态
                updateDetailLikeStatus();
                updateDetailBookmarkStatus();
                
                // 绑定点赞和收藏事件
                document.getElementById('likeBtn').onclick = function() {
                    toggleLike(event, articleId);
                };
                
                document.getElementById('bookmarkBtn').onclick = function() {
                    toggleBookmark(event, articleId);
                };
                
                // 加载该文章的评论
                loadComments(articleId);
                
                // 滚动到顶部
                window.scrollTo({
                    top: articleDetailSection.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        }
        
        // 更新详情页点赞状态
        function updateDetailLikeStatus() {
            if (!currentArticleId || !currentUser) return;
            
            const article = articles.find(a => a.id === currentArticleId);
            if (!article) return;
            
            const isLiked = likes[currentUser.id] && likes[currentUser.id].includes(currentArticleId);
            const likeBtn = document.getElementById('likeBtn');
            const likeText = document.getElementById('likeText');
            const likeCount = document.getElementById('likeCount');
            
            if (isLiked) {
                likeBtn.classList.add('liked');
                likeText.textContent = '已点赞';
            } else {
                likeBtn.classList.remove('liked');
                likeText.textContent = '点赞';
            }
            
            likeCount.textContent = `(${article.likes || 0})`;
        }
        
        // 更新详情页收藏状态
        function updateDetailBookmarkStatus() {
            if (!currentArticleId || !currentUser) return;
            
            const isBookmarked = bookmarks[currentUser.id] && bookmarks[currentUser.id].includes(currentArticleId);
            const bookmarkBtn = document.getElementById('bookmarkBtn');
            const bookmarkText = document.getElementById('bookmarkText');
            
            if (isBookmarked) {
                bookmarkBtn.classList.add('bookmarked');
                bookmarkText.textContent = '已收藏';
            } else {
                bookmarkBtn.classList.remove('bookmarked');
                bookmarkText.textContent = '收藏';
            }
        }

        // 显示文章列表
        function showArticlesList(event) {
            if (event) event.preventDefault();
            
            // 显示列表，隐藏详情和发布区域
            articlesSection.style.display = 'block';
            articleDetailSection.style.display = 'none';
            publishSection.style.display = 'none';
            bookmarksSection.style.display = 'none';
            
            // 滚动到文章列表
            articlesSection.scrollIntoView({
                behavior: 'smooth'
            });
        }

        // 加载评论
        function loadComments(articleId) {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = ''; // 清空现有内容
            
            // 筛选出该文章的评论
            const articleComments = comments.filter(c => c.articleId === articleId);
            
            if (articleComments.length === 0) {
                commentsList.innerHTML = '<p>暂无评论，欢迎发表您的看法。</p>';
                return;
            }
            
            // 按时间排序，最新的在前面
            articleComments.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            // 渲染评论，高亮搜索关键词 - 新增
            articleComments.forEach(comment => {
                let highlightedContent = comment.content;
                if (currentSearchTerm) {
                    const escapedTerm = currentSearchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    const regex = new RegExp(`(${escapedTerm})`, 'gi');
                    highlightedContent = highlightedContent.replace(regex, '<span style="background-color: #fff3cd; font-weight: bold;">$1</span>');
                }
                
                const commentElement = document.createElement('div');
                commentElement.className = 'comment-item';
                commentElement.innerHTML = `
                    <div class="comment-author">${comment.author}</div>
                    <div class="comment-date">${comment.date}</div>
                    <div class="comment-content">${highlightedContent}</div>
                `;
                commentsList.appendChild(commentElement);
            });
        }

        // 设置评论表单
        function setupCommentForm() {
            const commentForm = document.getElementById('commentForm');
            
            commentForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 检查是否有选中的文章
                if (!currentArticleId) {
                    alert('请先选择一篇文章');
                    return;
                }
                
                // 检查是否登录
                if (!currentUser) {
                    showAuthModal();
                    showSuccessMessage("请先登录后再评论");
                    return;
                }
                
                // 获取表单数据
                const author = document.getElementById('commentAuthor').value;
                const content = document.getElementById('commentContent').value;
                
                // 获取当前日期时间
                const today = new Date();
                const date = today.getFullYear() + '-' + 
                             String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                             String(today.getDate()).padStart(2, '0') + ' ' +
                             String(today.getHours()).padStart(2, '0') + ':' +
                             String(today.getMinutes()).padStart(2, '0');
                
                // 创建新评论对象
                const newComment = {
                    id: comments.length + 1,
                    articleId: currentArticleId,
                    author: author,
                    content: content,
                    date: date
                };
                
                // 添加到评论列表并保存到localStorage
                comments.push(newComment);
                localStorage.setItem('comments', JSON.stringify(comments));
                
                // 重新加载评论
                loadComments(currentArticleId);
                
                // 重置表单
                document.getElementById('commentContent').value = '';
                
                // 显示成功提示
                showSuccessMessage("评论发表成功");
            });
        }

        // 初始化画廊
        function initializeGallery() {
            const gallerySlider = document.getElementById('gallerySlider');
            const galleryIndicators = document.getElementById('galleryIndicators');

            // 创建幻灯片
            galleryImages.forEach((image, index) => {
                const slide = document.createElement('div');
                slide.className = 'gallery-slide';
                slide.innerHTML = `<img src="${image}" alt="意境图 ${index + 1}">`;
                gallerySlider.appendChild(slide);
            });

            // 创建指示器
            galleryImages.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.className = `gallery-indicator ${index === 0 ? 'active' : ''}`;
                indicator.addEventListener('click', () => goToSlide(index));
                galleryIndicators.appendChild(indicator);
            });
        }

        // 幻灯片控制
        function nextSlide() {
            currentSlide = (currentSlide + 1) % galleryImages.length;
            updateGallery();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + galleryImages.length) % galleryImages.length;
            updateGallery();
        }

        function goToSlide(index) {
            currentSlide = index;
            updateGallery();
        }

        function updateGallery() {
            const slides = document.querySelectorAll('.gallery-slide');
            const indicators = document.querySelectorAll('.gallery-indicator');

            slides.forEach((slide, index) => {
                slide.style.transform = `translateX(-${currentSlide * 100}%)`;
            });

            indicators.forEach((indicator, index) => {
                indicator.classList.toggle('active', index === currentSlide);
            });
        }

        // 滚动到文章区域
        function scrollToArticles() {
            showArticlesList();
        }

        // 生成与散文意境相符的随机图片URL
        function getRandomEssayImage() {
            // 随机选择一个分类
            const randomCategory = 散文意境图片分类[Math.floor(Math.random() * 散文意境图片分类.length)];
            // 生成随机数作为图片ID
            const randomId = Math.floor(Math.random() * 1000);
            // 返回随机图片URL，使用picsum.photos并指定分类
            return `https://picsum.photos/seed/${randomCategory}${randomId}/400/200`;
        }

        // 设置发布文章表单
        function setupPublishForm() {
            const form = document.getElementById('publishForm');
            const imageInput = document.getElementById('image');
            const imagePreview = document.getElementById('imagePreview');
            const previewImg = document.createElement('img');
            imagePreview.appendChild(previewImg);

            // 图片预览功能
            imageInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        imagePreviewUrl = event.target.result;
                        previewImg.src = imagePreviewUrl;
                        previewImg.style.display = 'block';
                        imagePreview.querySelector('span').style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                } else {
                    // 如果取消选择图片，显示随机图片提示
                    imagePreviewUrl = null;
                    previewImg.style.display = 'none';
                    imagePreview.querySelector('span').style.display = 'block';
                }
            });

            // 表单提交处理
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                
                // 检查是否登录
                if (!currentUser) {
                    showAuthModal();
                    showSuccessMessage("请先登录后再发布文章");
                    return;
                }
                
                // 获取表单数据
                const category = document.getElementById('category').value;
                const title = document.getElementById('title').value;
                const author = document.getElementById('author').value;
                const content = document.getElementById('content').value;
                const excerpt = document.getElementById('excerpt').value;
                
                // 计算阅读时间（大概估计）
                const wordCount = content.length;
                const readTime = Math.ceil(wordCount / 300) + '分钟';
                
                // 获取当前日期
                const today = new Date();
                const date = today.getFullYear() + '-' + 
                             String(today.getMonth() + 1).padStart(2, '0') + '-' + 
                             String(today.getDate()).padStart(2, '0');
                
                // 确定文章图片 - 如果没有上传则使用随机图片
                const articleImage = imagePreviewUrl || getRandomEssayImage();
                
                // 创建新文章对象
                const newArticle = {
                    id: articles.length + 1,
                    title: title,
                    excerpt: excerpt,
                    image: articleImage,
                    author: author,
                    date: date,
                    readTime: readTime,
                    category: category,
                    likes: 0,
                    content: content // 保存完整内容
                };
                
                // 添加到文章列表并保存到localStorage
                articles.unshift(newArticle); // 添加到列表开头
                localStorage.setItem('articles', JSON.stringify(articles));
                
                // 重新加载文章列表
                loadArticles();
                
                // 重置表单
                form.reset();
                previewImg.style.display = 'none';
                imagePreview.querySelector('span').style.display = 'block';
                imagePreviewUrl = null;
                
                // 发布成功后隐藏发布页面
                publishSection.style.display = 'none';
                
                // 显示成功提示
                showSuccessMessage("文章发布成功");
                
                // 自动滚动到文章列表
                showArticlesList();
            });
        }

        // 显示成功消息
        function showSuccessMessage(message) {
            document.getElementById('successMessage').textContent = message;
            document.getElementById('successModal').style.display = 'flex';
        }

        // 关闭模态框
        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
            document.getElementById('profileModal').style.display = 'none';
        }
    </script>
</body>
</html>

		
